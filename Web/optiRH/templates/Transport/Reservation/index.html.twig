{% extends 'partials/layout-horizontal.html.twig' %}

{% block title %}Réservation de trajets{% endblock %}

{% block topbar %}
    {{ include('partials/topbar.html.twig', { page_title: 'Réservation de trajets' }) }}
{% endblock %}

{% block body %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <!-- Barre de recherche -->
                <div class="row mb-3">
                    <div class="col-md-5">
                        <input type="text" id="depart" class="form-control" placeholder="Point de départ" required>
                    </div>
                    <div class="col-md-5">
                        <input type="text" id="arrive" class="form-control" placeholder="Point d'arrivée" required>
                    </div>
                    <div class="col-md-2">
                        <button id="searchBtn" class="btn btn-primary w-100">
                            <i class="mdi mdi-magnify me-1"></i> Rechercher
                        </button>
                    </div>
                </div>

                <!-- Résultats -->
                <div id="resultsContainer">
                    <div class="alert alert-info">
 Veuillez entrer au moins un point de départ ou d'arrivée                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascript %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Gestion de la recherche
    document.getElementById('searchBtn').addEventListener('click', function() {
        const depart = document.getElementById('depart').value;
        const arrive = document.getElementById('arrive').value;

        if (!depart && !arrive) {
            alert('Veuillez entrer au moins un point de départ ou d\'arrivée');
            return;
        }

        fetch(`{{ path('app_transport_reservation_search') }}?depart=${encodeURIComponent(depart)}&arrive=${encodeURIComponent(arrive)}`)
            .then(response => response.text())
            .then(html => {
                document.getElementById('resultsContainer').innerHTML = html;
            });
    });

    // Optionnel: permettre la recherche avec la touche Entrée
    ['depart', 'arrive'].forEach(id => {
        document.getElementById(id).addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('searchBtn').click();
            }
        });
    });
});
</script>
{% endblock %}